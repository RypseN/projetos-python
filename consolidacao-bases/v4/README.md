Esta é a versão que amarrou todas as pontas soltas. Depois de todas as adaptações, surgiu um último desafio: o banco de dados estava gerando informações de estoque negativo que, apesar de estranhas, precisavam ser consideradas no relatório.

Para lidar com esse cenário imprevisível, o script foi ajustado para considerar qualquer valor de estoque que não fosse zero. Essa mudança não apenas resolveu o problema, mas também tornou o código mais flexível para lidar com a natureza real dos dados.

Por enquanto, esta é a versão mais completa e confiável do script. A experiência com a base de dados mostrou que ele está pronto para evoluir e se adaptar a qualquer novo desafio.
